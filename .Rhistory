shiny::runApp('Affy_analisia')
library("BiocGenerics", lib.loc="~/R/win-library/3.2")
library("ggplot2", lib.loc="~/R/win-library/3.2")
library("simpleaffy", lib.loc="~/R/win-library/3.2")
library("affy", lib.loc="~/R/win-library/3.2")
runApp('Affy_analisia')
library("simpleaffy", lib.loc="~/R/win-library/3.2")
library(methylumi)
library(ggplot2)
library(reshape2)
library(plyr)
source("https://bioconductor.org/biocLite.R")
biocLite("methylumi")
library(methylumi)
package = "methylumi"),sep="\t",header=TRUE)
samps <- read.table(system.file("extdata/samples.txt",
package = "methylumi"),sep="\t",header=TRUE)
mldat <- methylumiR(system.file("extdata/exampledata.samples.txt" ,package="methylumi"),
qcfile=system.file("extdata/exampledata.controls.txt", package="methylumi"),
sampleDescriptions=samps)
head(mldat@phenoData@data)
x.chr.data <- exprs(mldat)[fData(mldat)$CHROMOSOME=="X",]
md <- cmdscale(dist(t(x.chr.data)), k=2)
colnames(md) <- c("First_dimension", "Second_dimension")
df <- data.frame(md, Gender=pData(mldat)$Gender)
ggplot(df, aes(x=First_dimension, y=Second_dimension, color=Gender)) +
geom_point()
df <- melt(pvals(mldat))
colnames(df) <- c("Gene", "Sample", "p_value")
sample_gender <- data.frame(Sample=pData(mldat)$SampleLabel, Gender=pData(mldat)$Gender)
df <- join(df, sample_gender, by="Sample")
ggplot(df, aes(x=Sample, y=p_value, fill="Gender")) + geom_boxplot()
ref <- createRefArray(mldat)
i <- 1
plotArray(mldat, i, ref) + labs(title=paste("Sample:", mldat@phenoData@data$SampleLabel[i]))
ref <- createRefArray(mldat)
createRefArray <- function(data) {
# Function to create an artificial array with the median values
# ARGS:
#   data - MethyLumiSet object with the data to create the reference
#
# RETURN:
#   A vector with the median values by row
#
expr <- data@assayData$betas
median.expr <- apply(expr, MARGIN=1, FUN=median)
return(median.expr)
}
source('~/UNI/BIO/Praktika_finala_affy/metilazioa.R')
ref <- createRefArray(mldat)
plotArray(mldat, i, ref) + labs(title=paste("Sample:", mldat@phenoData@data$SampleLabel[i]))
i <- 2
plotArray(mldat.norm, i, ref) + labs(title=paste("Sample:", mldat.norm@phenoData@data$SampleLabel[i]))
shiny::runApp('Affy_analisia')
